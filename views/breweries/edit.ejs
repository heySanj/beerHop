<% layout('./layouts/boilerplate') %> 

<h1>Edit Brewery: <%= brewery.name %></h1>

<form action="/breweries/<%= brewery._id %>?_method=PUT" method="POST" novalidate class="needs-validation" enctype="multipart/form-data">
  <div class="form-group mb-3">
    <label for="name">Brewery name:</label>
    <input type="text" class="form-control" name="brewery[name]" id="name"  value="<%= brewery.name %>" required>
    <div class="valid-feedback">Looks good!</div>
    <div class="invalid-feedback">Please enter a name.</div>
  </div>
  <div class="form-group mb-3">
    <label for="location">Location</label>
    <input type="text" class="form-control" name="brewery[location]" id="location" value="<%= brewery.location %>" required>
    <div class="valid-feedback">Looks good!</div>
    <div class="invalid-feedback">Please enter a Location.</div>
  </div>
  <div class="form-group mb-3">
    <label for="price">Price:</label>
    <div class="input-group mb-3">
      <div class="input-group-prepend">
        <span class="input-group-text">$</span>
      </div>
      <input type="number" class="form-control" name="brewery[price]" id="price" value="<%= brewery.price %>" required>
      <div class="valid-feedback">Looks good!</div>
      <div class="invalid-feedback">Please enter a valid price.</div>
    </div>
  </div>

  <!-- =================== IMAGES ======================= -->

  <div class="form-group mb-3">
    <label for="image">Delete Images:</label>
      <div class="row row-cols-1 row-cols-md-4 g-4 mb-3">
        <% brewery.images.forEach((image, i) => { %>
            <div class="col">
                <div class="card">
                    <img class="card-img" src="<%= image.thumbnail %>" alt="">
                    <div class="card-img-overlay text-end pt-1 pe-2">
                        <label class="visually-hidden" for="image-<%= i %>">Delete Image</label>
                        <input class="form-check-input" type="checkbox" name="deleteImages[]" value="<%= image.filename %>"  id="image-<%= i %>">
                    </div>
                </div>
            </div>
        <% }) %>
      </div>
  </div>


  <div class="form-group mb-3">
    <label for="image">Add Images:</label>
    <input type="file" class="form-control" name="image" id="image" multiple>
    <div class="valid-feedback">Looks good!</div>
    <div class="invalid-feedback">Please enter a valid image.</div>
  </div>

  <!-- =================================================== -->

  <div class="form-group mb-3">
    <label for="description">Description</label>
    <textarea class="form-control" name="brewery[description]" id="description" rows="3" required><%= brewery.description %></textarea>
    <div class="valid-feedback">Looks good!</div>
    <div class="invalid-feedback">Please enter a description.</div>
  </div>
  <button type="submit" class="btn btn-dark">Update</button> <a class="btn btn-danger cancelBtn" href="/breweries/<%= brewery._id %>" role="button">Cancel</a>
</form>